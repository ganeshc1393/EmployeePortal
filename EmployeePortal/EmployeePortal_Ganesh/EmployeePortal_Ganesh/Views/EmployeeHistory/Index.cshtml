@model EmployeePortal_Ganesh.Models.EmployeeHistory
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewBag.Title = "Employee History Screen";
}
<h2 style="text-align:center;font-weight:bold" class="form-control">@ViewBag.Title</h2>
@Html.HiddenFor(m => m.emp_no)
@Html.HiddenFor(m => m.emp_name)
<label class="label" style="text-align:center; color:blue;font-size:100%">@Model.emp_name</label>
(<label class="label" style="text-align:center; color:red;font-size:100%">#@Model.emp_no</label>)
<div class="row">
    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
        <div class="container">
            <br />
            <div style="width:90%; margin:0 auto;">
                <table id="example_history" class="table table-striped table-bordered dt-responsive nowrap" width="100%" cellspacing="0">
                    <thead>
                        <tr>
                            <th>Organization</th>
                            <th>Period</th>
                            <th>Location</th>
                            <th>Post</th>
                        </tr>
                    </thead>
                </table>
            </div>
        </div>
    </div>
</div>

<a href="~/Employee/EmployeeList">Back to list</a>
@section Scripts{

    <script src="~/Scripts/jquery-1.12.4.js"></script>
    <script src="~/Scripts/DataTables/jquery.dataTables.js"></script>
    <link href="~/Content/DataTables/css/jquery.dataTables.css" rel="stylesheet" />


    <script type="text/javascript">
        $(document).ready(function () {
            fnbind_grid_bysearch();
        });
        function fnbind_grid_bysearch() {
            var emp_no = $("#emp_no").val();
            $.ajax({
                type: "POST",
                url: "/EmployeeHistory/GetEmployeeHistory?emp_no=" + emp_no,
                data: '{}',
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (response) {
                    OnSuccess(response);
                },
                failure: function (response) {
                    alert(response.d);
                },
                error: function (response) {
                    alert(response.d);
                }
            });
        }
        function OnSuccess(response) {
            var provTable = $("#example_history").DataTable(
                {
                    destroy: true,
                    aaData: response.data,
                    bLengthChange: true,
                    lengthMenu: [[20, 50, -1], [20, 50, "All"]],
                    bFilter: false,
                    bSort: false,
                    bPaginate: true,
                    data: response,
                    columns: [
                        {
                            'data': function (data, type, dataToSet) {
                                return data.organization_name
                            }
                        },
                        {
                            'data': function (data, type, dataToSet) {
                                return data.until_date + "~" + data.from_date;
                            }
                        },
                        {
                            'data': function (data, type, dataToSet) {
                                return data.location + "(" + data.country + ")";
                            }
                        },
                        {
                            'data': function (data, type, dataToSet) {
                                return data.post;
                            }
                        }]
                });
        };


    </script>
}
